"use strict";(globalThis.webpackChunkcontribuinte_checkout=globalThis.webpackChunkcontribuinte_checkout||[]).push([[239],{239:(t,e,i)=>{i.r(e),i.d(e,{default:()=>k});var n=i(609),o=i(143),c=i(87),r=i(703),a=i(656),u=i(594),s=i(0),l=i(723);const _={vat:(0,l.__)("VAT","contribuinte-checkout"),optional:(0,l.__)("(Optional)","contribuinte-checkout"),fiscalDetails:(0,l.__)("Fiscal details","contribuinte-checkout"),enterValidVat:(0,l.__)("Please enter a valid VAT number","contribuinte-checkout"),manageSettings:(0,l.__)("Manage field settings","contribuinte-checkout"),manageSettingsDescription:(0,l.__)("Options that control this section can be managed in the plugin settings page.","contribuinte-checkout"),behaviourOptions:(0,l.__)("Behaviour Options","contribuinte-checkout"),fieldLabel:(0,l.__)("Field label","contribuinte-checkout"),sectionDescription:(0,l.__)("Section description","contribuinte-checkout"),sectionTitle:(0,l.__)("Section title","contribuinte-checkout"),visualOptions:(0,l.__)("Visual Options","contribuinte-checkout"),debug:(0,l.__)("Debug","contribuinte-checkout")},b={showStepNumber:!0,sectionTitle:_.fiscalDetails,sectionDescription:"",inputLabel:_.vat},{drop_down_is_required:d,drop_down_required_over_limit_price:h,drop_down_validate_vat:p,drop_down_on_validation_fail:g}=(0,r.getSetting)("contribuinte-checkout_data",""),k=t=>{const{extensions:e,checkoutExtensionData:i,showStepNumber:r,sectionTitle:l,sectionDescription:k,inputLabel:m}=t;console.log(_);const{setExtensionData:S}=i,T=(0,o.useSelect)((t=>t(u.CHECKOUT_STORE_KEY)?.isProcessing()),[]),v=(0,o.useSelect)((t=>t(u.CART_STORE_KEY)?.getCartTotals()),[]),f=(0,o.useSelect)((t=>t(u.CART_STORE_KEY)?.getCustomerData()),[]),V=(0,c.useMemo)((()=>{try{return e["contribuinte-checkout"].billingVat||""}catch(t){return""}}),[]),[E,w]=(0,c.useState)(V),C=(0,c.useMemo)((()=>{if(d)return!0;if(!h)return!1;let t=0;try{t=v?.total_price||0}catch(t){}return t>1e5}),[v]),D=(0,c.useMemo)((()=>{let t="";try{t=f?.billingAddress?.country||""}catch(t){}let e=E.toString().trim();return"PT"!==t||(t=>{if(9!==t.length)return!1;if(!/^\d+$/.test(t))return!1;let e=t.split("").map(Number),i=0;for(let t=0;t<8;t++)i+=e[t]*(9-t);let n=i%11;return(0===n?0:11-n)===e[8]})(e)}),[E,f]),O=(0,c.useCallback)((t=>!(p&&!D&&!g&&(t.setCustomValidity(_.enterValidVat),1))),[D]);return(0,c.useEffect)((()=>{S("contribuinte-checkout","billingVat",E)}),[E,S]),(0,n.createElement)(a.FormStep,{id:"fiscal-details",disabled:T,title:l&&""!==l?l:b.sectionTitle,description:k||b.sectionDescription,showStepNumber:"true"===(r||b.showStepNumber||"true").toString()},(0,n.createElement)(s.ValidatedTextInput,{id:"billing_vat",errorId:"billing_vat",type:"text",value:E,showError:!0,validateOnMount:!0,onChange:w,customValidation:O,required:C,errorMessage:g&&!D&&""!==E?_.enterValidVat:"",label:`${m&&""!==m?m:b.inputLabel} ${C?"":_.optional}`}))}}}]);